M = [
  8.1609299516E+00  0.0000000000E+00  5.7245874707E-16 -2.7755575616E-16  0.0000000000E+00  1.3877787808E-16 -2.7755575616E-17  1.1102230246E-16 -2.7755575616E-16  2.6174334510E-16 
  3.5601202220E-16  5.5258220389E+01  2.8427678269E-16  1.0777236102E-15  1.2529308155E-16 -2.7799501670E-17 -6.7467289374E-16  1.0638273169E-15 -2.2977894736E-16 -4.3577912336E-15 
  5.1225236842E-16  1.2446938446E-15  7.0798974549E+00  6.2052260595E-17 -2.4510023490E-16 -8.6986404606E-17 -3.6280852845E-17  5.4821994112E-16 -1.4884066298E-16 -2.8594322639E-16 
  1.6653345369E-16  1.9984014443E-15 -4.4408920985E-16  8.6527120974E+00 -5.5511151231E-17 -3.8857805862E-16  1.5612511284E-17  7.2164496601E-16 -5.5511151231E-17  3.2092384306E-16 
  2.9503420126E-16  3.3528335746E-16  9.0642470370E-18  1.2242308311E-16  4.0023570064E+00  1.3515366904E-16  2.5376068476E-17 -1.2157768718E-16 -3.0153747970E-16  8.7204052738E-17 
 -1.1102230246E-16  0.0000000000E+00  4.9960036108E-16 -2.2204460493E-16  2.2204460493E-16  3.8834466690E+00  3.8163916471E-17  1.1102230246E-16  0.0000000000E+00 -1.3877787808E-17 
  1.2148631972E-17 -6.8798163655E-16 -1.4064061854E-16 -2.4022674425E-18  3.7406512352E-17  2.8910850865E-17  3.5973921722E+00 -4.9619010437E-18 -1.7674116555E-17  5.5494106062E-16 
  0.0000000000E+00  1.1657341759E-15  4.4408920985E-16  2.7755575616E-16 -2.2204460493E-16  2.2204460493E-16 -1.7347234760E-18  3.1426008423E+00  0.0000000000E+00 -1.7000290065E-16 
 -4.4408920985E-16 -2.2204460493E-16 -2.7755575616E-16 -5.5511151231E-17 -2.2204460493E-16 -1.1102230246E-16 -1.9081958236E-17 -1.6653345369E-16  1.0162531287E+00  1.0408340856E-17 
  2.3572950378E-16 -4.2077534582E-15  1.2809608429E-16  3.6716271207E-16 -1.6831361330E-17 -7.8933567317E-17  5.5859925161E-16 -2.0882146052E-16  2.0844630539E-17  8.6170187086E+00 
];
K = [
  1.3365712282E+03 -5.9117155615E-12 -8.0174089589E-11 -4.3655745685E-11  3.6379788071E-12  5.9685589804E-11  1.1823431123E-11  4.7293724492E-11 -1.2732925825E-11 -1.2956302697E-12 
 -5.5013778929E-12  2.7532238802E+04 -2.8660006297E-11  2.0679544362E-11 -6.1985343575E-12  1.8636810220E-11 -4.9594913088E-11 -2.1006377143E-11 -4.9488144151E-11 -1.2745115400E-10 
 -6.7338154031E-11 -4.7758487151E-11  1.4815038649E+04  9.8955119871E-12  1.7764066103E-11  5.6514779111E-11 -6.4165568210E-11 -5.6939013000E-11 -2.3838378999E-11 -6.1100932005E-11 
 -3.6294522943E-11  2.1202595235E-11 -5.0022208598E-12  4.6749508938E+04  1.9099388737E-11 -1.2732925825E-10  7.8813400251E-11 -3.4197000787E-10  1.4188117348E-10  1.7234924599E-10 
  2.8832138567E-12  2.5319479635E-11  1.4023904444E-11  2.6933892032E-11  3.4988966287E+04  3.6453543015E-11  4.6521146087E-11  1.8170235368E-11 -1.9306203215E-10  3.1063339192E-11 
  6.6663119469E-11  9.2654772743E-12  9.8907548818E-12 -4.9112713896E-11  2.0463630790E-11  6.8581954194E+04  8.5407236838E-11  6.6575012170E-10 -2.7284841053E-10  1.0834355635E-10 
  1.1838226970E-11 -5.3061772290E-11 -7.5858580502E-11  1.3030851899E-10  1.2533870211E-10  2.7825551366E-10  8.6281960079E+04  1.4469416097E-11 -2.6883656296E-10 -2.2110158131E-10 
  5.1912252275E-11  2.8791191653E-11 -8.7879925559E-11 -3.8971847971E-10 -5.6843418861E-11  7.1486283559E-10 -5.6303406382E-11  1.3236206070E+05  2.6557245292E-10  6.4801497501E-10 
 -2.3803181648E-11 -1.6655121726E-11  1.8758328224E-11  9.5951691037E-11 -1.3960743672E-10 -2.5829649530E-10  2.9217517294E-11  2.1464074962E-10  6.1186690037E+04 -1.6075318854E-10 
  4.9710687466E-11 -2.1435602209E-10  2.2797072881E-11 -1.3452727290E-10 -6.2339930421E-10 -9.2620444095E-10  3.0127069648E-12  1.5177109489E-10  1.6577918791E-09  7.9131841582E+05 
];
A = [
 -0.143234 0. 0. 0. 0. 0. 0. 0. 0. 0.
0.  -0.144952 0. 0. 0. 0. 0. 0. 0. 0.
0. 0.  -0.146674 0. 0. 0. 0. 0. 0. 0.
0. 0. 0.  -0.544399 0. 0. 0. 0. 0. 0.    
0. 0. 0. 0.  -0.569379 0. 0. 0. 0. 0.
0. 0. 0. 0. 0.  -0.59303  0. 0. 0. 0.
0. 0. 0. 0. 0. 0.  -0.610808 0. 0. 0.
0. 0. 0. 0. 0. 0. 0.  -0.635892 0. 0.
0. 0. 0. 0. 0. 0. 0. 0.  -0.783701 0.
0. 0. 0. 0. 0. 0. 0. 0. 0.   -0.787191
];
B = [
   47.0528     -686.12        16.5826     -38.0807      -402.933       7.05808     -173.211       -21.6095     -132.782      -40.6923  
    7.30685    -104.189        2.63594     -5.50982      -60.7725      1.173        -26.722        -3.26034     -20.2089      -6.27254 
    8.70986    -123.707        3.13176     -6.96589      -72.977       1.31133      -30.6668       -3.77499     -23.905       -7.22424 
   10.098       -25.1015       3.46353     -0.420799     -16.9083      3.52155       -9.1645       -4.43187      -3.05564     -2.29864 
  -29.306        47.3195      -4.94213      0.6353        35.1009     -4.21877        6.16796       3.22932      12.5627      -1.88055 
   -5.92823      29.2464       6.65399     -6.48007       11.3255     -0.491332      13.7988       -1.79928       2.73178     -7.51063 
    1.20282      -8.31962     16.1295      -1.56793       -3.3541      2.79036       -6.74859      -2.99799      -4.27096     -9.67177 
  -10.0376        8.71582     -4.83028     -3.86563        8.26687    -5.44888        0.592319      1.36228       3.28439     -0.398643
   -2.60037       1.94323    -13.2241      -7.78308        4.24653    -2.96156       -2.20139       1.94123       1.37816      1.73278 
  -33.1428      135.608        9.6995       3.40457       74.4153     -3.11605       42.3884        2.60116      24.8316       2.68144 
];
C = [
   0.0401036       0.064171     -0.0424462      0.325336     -1.74835      -0.235064     -0.237007     -0.627787     -0.202951      0.431023 
  -0.101483        0.212122      0.285817      -0.162803      0.638734      0.560715      0.50711       0.475847     -0.092825      0.618298 
   0.0785441      -0.124855     -0.404717       0.103488     -0.137869      0.122238      1.09092      -0.202736     -0.310166      0.0539693
  -0.0610851       0.635263     -0.129974      -0.130586     -0.334735     -0.201382     -0.288227     -0.154205      0.0368133     0.267358 
  -0.146224        0.214497      0.596546      -0.0696048     0.870072     -0.0212705    -0.171393      0.317369      0.265606      0.372775 
   0.000278119     0.0440001    -0.00189387     0.888213     -0.059663      0.0407691    -0.102643     -0.0937528    -0.0734755     0.0907788
   0.0122541      -0.0464972    -0.075597       0.112132      0.0668042     0.903273      0.0448317     0.0334667    -0.0252408    -0.0813004
  -0.0143868      -0.0339364     0.121072      -0.0467769     0.0573363    -0.123677     -0.227613      0.118234      1.11315       0.0144974
  -0.0331429       0.0246564     0.147979      -0.0664797     0.044953     -0.0440488    -0.142786      1.06913       0.110766      0.0742096
  -0.0243648      -0.224424      0.417162      -0.188955     -0.356714     -0.391039     -0.488666     -0.276907      0.0628863     0.320026 
];
D0 = [
  -102.581      -1380.44        35.3301     -177.895     -1308.91       -48.6625     -123.277       -458.989     -552.694      -73.5713   
    77.6526       520.083      -50.1295       53.7651      209.408        6.35401     111.151        -78.8363      43.1322      70.1947   
    -9.18562        1.53783    -47.1008      -61.6684     -596.716      -52.8863      164.463       -706.432     -462.852       53.6142   
   -11.3379      -275.982        8.79667     -41.6703     -243.636      -36.8546     -169.912       -567.998     -389.538      -81.5781   
    69.2364       447.123       -7.29152      76.0189      553.789       25.656        -6.04236      236.403      219.986       13.3948   
   -19.0661      -266.668        1.12338     -47.8824     -333.321      -45.9414        7.13849     -310.736     -455.016      -21.1382   
     9.60913       97.7247     -15.9254       11.3144       -8.62242     -3.75738     153.82         -10.2488     -14.2832      71.8923   
     9.07418       28.7753      30.7911       37.4241      234.318       30.4764       -3.49394      440.106      237.997       -0.0333685
    24.6649       178.167        8.28244      40.5574      240.844       37.1029       -0.707958     240.444      294.021       13.7933   
   -13.1581      -259.885       20.8269      -16.6367      -80.8877       5.85951    -228.098         45.0451       5.51169    -91.1961   
];
D1 = [
  -735.962      -2294.12     -187.86       -420.175     -1985.96      -243.322      -162.562       -536.238     -758.177      -123.951 
   155.249      -1737.31       -6.13009    -106.971      -971.312       13.2748     -332.247          5.5263    -319.941       -78.0845
  -292.336        370.576    -485.696      -306.053      -820.848     -272.411       370.569      -1223.44      -674.539       158.409 
  -156.235       -611.81     -208.573      -461.945      -354.371     -240.292      -438.006      -1157.21      -672.314      -223.658 
   292.864       -534.333     177.988       -19.6914     -780.988       72.3211       62.6851      -164.962     -211.755        30.4231
  -211.464       -425.027    -183.674      -243.889      -468.06      -338.408        17.4384      -474.642     -846.554       -33.4477
     5.40294     -411.071     -21.2288       35.7229       32.0173      -4.73705    -535.285        -17.9778     -17.9339      -85.0572
   118.082        170.983     194.394       190.417      -171.22        64.5243       -1.20651     -648.382     -215.624       -15.1967
   140.319       -131.414     134.485        95.481      -206.884      126.675        12.5416      -213.329     -324.738       -12.175 
   -46.1085      -603.083      78.7669      -34.5169      -76.6588      30.5257     -955.518         67.2561      -9.93142    -490.309 
];
D2 = [
  -748.991     -619.635     -187.15      -195.877     -409.274     -192.432       -66.9353      -66.3506     -127.905       -92.1127 
  -308.053     -666.146       68.3444    -115.642     -251.605      -54.3171     -178.444        46.9803      -71.2425     -123.035  
  -200.873      177.97      -566.042     -205.803     -143.983     -191.887       157.965      -248.399      -102.128       173.481  
  -167.527     -195.573     -197.248     -558.645      -19.9284    -175.14       -176.801      -225.78       -103.306      -164.418  
  -150.37      -213.862      -54.7702      14.0151    -211.313      -18.3653       15.956        -2.96079     -41.6489        8.7662 
  -195.6        -87.675     -183.394     -177.27       -65.3909    -335.386        12.8436      -54.9396     -145.58         10.0799 
   -21.1948    -180.994       75.3478     -98.5766      14.9572       2.38031    -269.522        -8.03315      -5.80381    -243.889  
   -11.1613      59.9466    -101.168     -113.497      -10.8519     -12.9216       -5.29486    -179.5         -30.1631        3.42635
   -37.6937     -45.9702     -31.4272     -38.0754     -35.9668     -61.7553       -2.06186     -30.913       -71.2033       -3.31628
   -71.1825    -255.616      149.363     -133.925      -18.3914      14.2804     -366.718        23.3043       -5.08994    -579.774  
];

% Problem reference data
chord = 131.25/2;
rho = 1.1468e-7;

% Airspeed range
v = [0:100:20000];

[ns, dmy] = size(M);
[na, dmy] = size(A);

% Compute V-g
for i = 1:length(v),
	V = v(i);
	q = rho/2*V^2;
	if (i == 1),
		% Catch zero speed, don't make matrices undefined
		V = 1;
	end
	
	AA = [
		zeros(ns), 	-eye(ns), 		zeros(ns, na);
		(K - q*D0),	-q*(chord/V)*D1,	-q*C;
		-(V/chord)*B,	zeros(na, ns),		-(V/chord)*A
	];
	BB = [
		eye(ns),	zeros(ns),		zeros(ns, na);
		zeros(ns),	(M - q*(chord/V)^2*D2),	zeros(ns, na);
		zeros(na, ns),	zeros(na, ns),		eye(na)
	];

	[vv, ll] = eig(-BB\AA);

	% Save eigenvalues (FIXME: sort?)
	l(:, i) = diag(ll);
end


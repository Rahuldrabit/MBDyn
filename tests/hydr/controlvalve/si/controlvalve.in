# $Header: /var/cvs/mbdyn/mbdyn/mbdyn-1.0/tests/hydr/controlvalve/si/controlvalve.in,v 1.4 2014/12/13 17:15:41 masarati Exp $

begin: data;
    problem: initial value;

end: data;

begin: initial value;
    abort after: input;
    time step: (real dt = 1.e1);
    initial time: 0.;
    final time: 100*dt;
    
    set: (real Rho = .6);
    method: ms, Rho, Rho;
    
    max iterations: 10;
    tolerance: 1.e-5;
    
    derivatives coefficient: 1.e-6;
    derivatives max iterations: 100;
    derivatives tolerance: 1.e-6;

    # output: iterations;
threads: disable;
end: initial value;



begin: control data;
  hydraulic nodes: 4;       #  numero nodi idraulici
  hydraulic elements: 2;   #  numero elementi idraulici
  forces: 1;                 #  generatore di portata
  genels: 3;                # generatori di pressione
end: control data;
 
begin: nodes;
    hydraulic: 1;
    hydraulic: 2; #(real p2=1.e4); # uscita
    hydraulic: 3; #(real p3=8.e4); # in utilizzatore
    hydraulic: 4; #(real p4=4.e4); # out utilizzatore
end: nodes;

begin: elements;
 
 # density                  800 kg/m^3		kappa		     10 N/m
 # diametro               0.007 m		precarico	    300 N 
 # viscosità    	    0.9 kg/m/s		larghezza          5e-3 m
 # area tubo   	       3.84 e-5 m^2		massa		  1.e-3 kg 
 # lunghezza		      1	m 		area massima      2.e-4 m^2
 # area diaframma        2. e-5 m^2 50% area tubo  

  hydraulic: 2, minor loss, 3, 4,
		.1, .1,		# kappa
		3.84e-5,	# area tubo
		hydraulic fluid, incompressible, density, 800., viscosity, 0.9;

  hydraulic: 1, control valve, 1, 2, 3, 4,
		1.,
	   	-1,
		hydraulic fluid, incompressible, density, 800., viscosity, 0.9;

 # forza generico: generatore di portata
   force: 1, abstract, 
          3, hydraulic,
          const, -100;
          # step,1.e-3,1.e-3,1.e-3;
          # array, 2,
	  # random, .01,0.,dt,1000., steps, 10;
	  # sine, 0.,pi,1.e-4,0,0.;  
          # linear, -1.e-2,-1.e-5;
          #  step,5.,-1.e-6,-1.e-3;
 
# incastro generico: generatore di pressione
   genel: 1, clamp,    # 2 uscita
            2, hydraulic, 
	    const, 1.e4;       # const, p2;
            #step,4,p1,p1;
            #linear, 1.8e7,5.e7; # per il tubo
            #linear, p1,-5.e3; # per la valvola di pressione
	    #linear, 1.5999e6,50/dt; #per la valvola di portata
	    # linear, 1.e5,10;
            # sine, 0.1,pi,1.e6,0,500000.;

# incastro generico: generatore di pressione
   genel: 2, clamp,     # in utilizzatore
            1, hydraulic, 
	    const, 1.e5;
	    # const, p2;
            # step,2.,1.e8,1.e5;
            #linear, 1,-1.e6;
	    # sine, 0.1,pi,1.e6,0,500000.;

# incastro generico: generatore di pressione
   genel: 3, clamp,   # out utilizzatore
            4, hydraulic, 
	    const, 4.e4;
            # step,2.,1.e5,1.e8;
            #linear, 1.e7,1.e6;
	    # sine, 0.1,pi,1.e6,0,500000.;
end: elements;

##############################################################################################################
## Variables to be updated by simple_testsuite.sh --update-reference-test-status
## Warning, do not edit!!!
## @MBDYN_SIMPLE_TESTSUITE_EXIT_STATUS@ = 0
##############################################################################################################

## @MBDYN_SIMPLE_TESTSUITE_EXCLUDE@ = 1
